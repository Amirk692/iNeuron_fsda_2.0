USE AM_WINDOW_FUNCTIONS;

CREATE OR REPLACE TABLE HRR(
EMP_ID INT NOT NULL,
NAME VARCHAR (20),
ROLE VARCHAR(20),
SALARY INT
);

INSERT INTO HRR
VALUES('101','ANAND JHA','Analyst',50000);

INSERT INTO HRR
VALUES('114','AAMIR','Analyst',50000);

INSERT INTO HRR
VALUES('114','SAMEER','Analyst',50000);

INSERT INTO HRR
VALUES(102,'ALex', 'Data Engineer',60000);

INSERT INTO HRR
VALUES(102,'MICHAEL', 'Data Engineer',60000);

INSERT INTO HRR
VALUES(103,'Ravi', 'Data Scientist',48000);

INSERT INTO HRR
VALUES(103,'KOUSHALYA', 'Data Scientist',48000);

INSERT INTO HRR
VALUES(120,'KANCHAN', 'Data Scientist',30000);

INSERT INTO HRR
VALUES(104,'Peter', 'Analyst',98000);

INSERT INTO HRR
VALUES(104,'SAM', 'Analyst',45000);

INSERT INTO HRR
VALUES(105,'Pulkit', 'Data Scientist',72000);

INSERT INTO HRR
VALUES(106,'Robert','Analyst',100000);

INSERT INTO HRR
VALUES(107,'Rishabh','Data Engineer',67000);

INSERT INTO HRR
VALUES(108,'Subhash','Manager',148000);

INSERT INTO HRR
VALUES(108,'Dheena','Manager',148000);

INSERT INTO HRR
VALUES(108,'Balaji','Manager',148000);

INSERT INTO HRR
VALUES(108,'Senthil','Manager',100000);

INSERT INTO HRR
VALUES(109,'Michaeal','Manager',213000);

INSERT INTO HRR
VALUES(110,'Dhruv','Data Scientist',89000);

INSERT INTO HRR
VALUES(111,'Amit Sharma','Analyst',72000);

SELECT * FROM HRR;

-- ROW_NUM
SELECT *,ROW_NUMBER() OVER(ORDER BY MAX(SALARY) DESC) AS ROW_NUM
FROM HRR
GROUP BY 1,2,3,4;

-- RANK
SELECT *,RANK() OVER(PARTITION BY ROLE ORDER BY MAX(SALARY)DESC) AS RANK_NUM
FROM HRR
GROUP BY 1,2,3,4;

-- DENSE_RANK

SELECT *, DENSE_RANK() OVER(PARTITION BY ROLE ORDER BY MAX(SALARY)DESC) AS DENSE_RANK_NUM
FROM HRR
GROUP BY 1,2,3,4;






